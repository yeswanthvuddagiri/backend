"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.redact = redact;
const regexes_1 = require("./regexes");
const plainObjectTag = Object.prototype.toString.call({});
function isPlainObject(val) {
    if (typeof val !== 'object' ||
        !val ||
        Object.prototype.toString.call(val) !== plainObjectTag) {
        return false;
    }
    const proto = Object.getPrototypeOf(val);
    if (proto === null)
        return true;
    if (!Object.prototype.hasOwnProperty.call(proto, 'constructor'))
        return false;
    const ctor = proto.constructor;
    if (typeof ctor !== 'function')
        return ctor;
    const ctorPrototype = Object.getPrototypeOf(ctor);
    return Object.getPrototypeOf(ctorPrototype) === ctor.prototype;
}
function redact(message) {
    if (isPlainObject(message)) {
        return Object.fromEntries(Object.entries(message).map(([key, value]) => [key, redact(value)]));
    }
    if (Array.isArray(message)) {
        return message.map(redact);
    }
    if (typeof message !== 'string') {
        return message;
    }
    for (const [regex, replacement] of regexes_1.regexes) {
        message = message.replace(regex, replacement);
    }
    return message;
}
exports.default = redact;
//# sourceMappingURL=index.js.map